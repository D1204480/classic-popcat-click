<!--設定格式為HTML5版本-->
<!DOCTYPE html>

<!--語系原為en,這裡改為台灣中文-->
<html lang="zh-Hant-TW">

<!--head存放網頁資訊, 例如title、meta、style-->
<head>
    <!--網頁分頁的名稱, 搜尋引擎會找這個名稱-->
    <title>POPCAT CLASSIC</title>

    <!--用lighthouse跑分, 可參考SEO建議修改, 讓SEO分數提高-->
    <meta name="author" content="Joshua O'Sullivan, Freddy Heppell, Edward Hails">
    <meta name="description" content="Put your description here.">
    <meta name="viewport">

    <!--文件編碼, UTF-8很常用, 有包括英文、中文-->
    <meta charset="UTF-8">

    <!--主題色可以做設定, 但非每個瀏覽器都可以支援, ios可以看到, chrom看不到-->
    <meta name="msapplication-TileColor" content="#b721ff">
    <meta name="theme-color" content="#b721ff">

    <!-- Google font -->
    <!--下面link載入字型檔, 物件的font-family也要記得修改, 才會顯示所設定的字型-->
<!--    <link rel="preconnect" href="https://fonts.gstatic.com">-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!--text=0123456789,可以降低字型檔的大小, 因此可以加速網頁執行-->
<!--    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@900&display=swap&text=0123456789" rel="stylesheet">-->
    <link href="https://fonts.googleapis.com/css2?family=Madimi+One&family=Noto+Sans+Khojki&display=swap%text=0123456789" rel="stylesheet">


    <!--匯入css檔-->
    <!--通常css的檔案可能會和別人協作, 因此會用link的方式連結css檔, 不會直接寫在html裡 -->
    <link rel="stylesheet" href="styles.css">

    <style>
        html { height:100%; overflow:hidden; }
        body {
            height:100%;
            margin:0;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            background-color: #bdaa90;
            user-select: none;
            -moz-user-select: none;
            -webkit-user-select: none;
            position:relative;
            overflow:hidden;
        }
        body::before{
            content:"";
            position:absolute;
            width:120%;height:120%;
            top:50%;left:50%;
            z-index:-1;
            transform:translate(-50%,-50%) rotate(-3deg);
            background-image: url("imgs/bg.jpg");
            background-repeat: repeat-x;
            background-size: contain;
        }

        /* "." 為class選擇器*/
        .title {
            /*預設font-size為16px*/
            /*margin邊界:上下左右*/
            /*em為倍數大小, 相關於font-size大小*/
            margin:2em 0 0 0;
            /*min(a,b), 兩者取小的值*/
            /*值%會一直變動, 繼承父元素*/
            width: min(600px,80%);
        }

        .cat-img {
            height:0;
            flex-grow:1;
            width:100%;
            max-width: 800px;
            background-position: bottom;
            background-size: contain;
            background-repeat: no-repeat;
            touch-action: manipulation;
            text-align: center;
            color:white;
            -webkit-text-stroke-width: 3px;
            -webkit-text-stroke-color: black;
            font-weight:900;
            font-size:80px;
            font-family: "Madimi One", sans-serif;
            word-wrap: break-word;
        }
        @media(min-width:1000px) {
            .title {
                width: min(400px,80%);
            }
            .cat-img {
                font-size: 40px;
                -webkit-text-stroke-width: 1.5px;
            }
        }
        /*css取連結檔案用url*/
        #p { background-image: url("imgs/p.png"); }
        #op { background-image: url("imgs/op.png"); }
    </style>
</head>

<!--給使用者看的內容-->
<body>
<!--alt為圖片無法顯示的時候, 秀給使用者看的文字內容-->
<!--img裡必要attribute有 src,alt-->
<img class="title" src="imgs/popcat.svg" alt="POPCAT">

<!--div為一區塊-->
<div class="cat-img" id="p">123456TEXT中文</div>

<script>
    /*Preloading alternate cat image*/
    preload = new Image();
    preload.src = "imgs/op.png";

    /*Cat elem*/
    cat = document.getElementById("p")

    /*Pop mp3s*/
    pops = [
        "pops/pop1.mp3",
        "pops/pop2.mp3",
        "pops/pop3.mp3",
        "pops/pop4.mp3",
    ]
    pop_i = 0

    /*Cookie utils*/
    function getCookie(cname) {
        var name = cname + "=";
        var decodedCookie = decodeURIComponent(document.cookie);
        var ca = decodedCookie.split(';');
        for(var i = 0; i <ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) == ' ') {
                c = c.substring(1);
            }
            if (c.indexOf(name) == 0) {
                return c.substring(name.length, c.length);
            }
        }
        return "";
    }
    function setCookie(cname, cvalue, exdays) {
        var d = new Date();
        d.setTime(d.getTime() + (exdays*24*60*60*1000));
        var expires = "expires="+ d.toUTCString();
        document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
    }

    pop_count = getCookie("pop_count")
    cat.innerHTML = pop_count > 0 ? pop_count : ""

    op_func = function(){
        /*Chance cat image to op.jpg via css*/
        cat.id = "op"

        /*Play pop noise*/
        a = new Audio(pops[pop_i])
        a.load()
        a.play()

        /*Increment index for next pop noise*/
        pop_i = (pop_i+1)%pops.length

        /*Increment pop count*/
        pop_count++
        cat.innerHTML = pop_count
        setCookie("pop_count",pop_count,365)

        /*Fire google analytics event for pop*/
        // gtag('event', 'pop');
    }
    p_func = () => setTimeout(() => cat.id = "p", 25)

    document.addEventListener("pointerup", p_func)
    document.addEventListener("keyup", p_func)
    document.addEventListener("pointerdown", op_func)
    document.addEventListener("keydown", op_func)
</script>
</body>
</html>